<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login</title>
    <link
      rel="stylesheet"
      href="	https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />
    <style>
      ul {
        list-style: none;
      }
      ul a {
        text-decoration: none;
        color: #090909;
      }
      .profile-photo-md {
        height: 100px;
        width: 100px;
        object-fit: cover;
        object-position: center;
        border-radius: 50%;
      }

      #profile-card {
        position: relative;
      }
      #edit-btn {
        display: none;
        position: absolute;
        top: 1rem;
        right: 1rem;
        background-color: rgb(235, 180, 31);
        color: #000;
        padding: 3px 7px;
        border-radius: 50%;
        transition: all 0.5s ease-in;
      }
      #profile-card:hover #edit-btn {
        display: block;
      }

      .photo {
        position: relative;
      }
      #upload-btn {
        display: none;
        position: absolute;
        bottom: 2px;
        right: 3px;
        background-color: #352968;
        color: #fff;
        padding: 5px 9px;
        border-radius: 50%;
        transition: all 0.5s ease-in;
        font-size: 15px;
        z-index: 5;
      }

      .photo:hover #upload-btn {
        display: block;
      }
    </style>
  </head>
  <body>
    <div
      class="container-fluid d-flex justify-content-between align-items-center shadow-sm py-3 px-5"
    >
      <h1 class="fs-5">candidate dashboard</h1>
      <ul class="text-decoration-none d-flex m-0">
        <li class="mx-2"><a href="/logout">Logout</a></li>
      </ul>
    </div>

    <% var photo; if(userInfo.image == "" || userInfo.image == null){ photo =
    "/avatar.jpg" }else{ photo = userInfo.image; } %>

    <section class="container py-5">
      <div class="row justify-content-center">
        <div class="col-md-5">
          <% if(!userInfo.hasProfile){ %>

          <div class="alert alert-success">
            <p>
              Dear Candidate, Please complete your profile first.
              <a href="#" data-bs-toggle="modal" data-bs-target="#edit-modal"
                >click here</a
              >
            </p>
          </div>

          <%}%>

          <div class="card w-100 shadow rounded-sm border-0" id="profile-card">
            <div
              class="card-body d-flex flex-column align-items-center justify-content-center"
            >
              <a
                href="#"
                data-bs-toggle="modal"
                class="ms-auto"
                id="edit-btn"
                data-bs-target="#edit-modal"
                ><i class="bi bi-pencil"></i
              ></a>
              <div class="photo">
                <img src="<%= photo %>" alt="" class="profile-photo-md" />
                <a
                  href="#"
                  data-bs-toggle="modal"
                  class="ms-auto"
                  id="upload-btn"
                  data-bs-target="#upload-modal"
                  ><i class="bi bi-camera"></i
                ></a>
              </div>
              <h4 class="card-title"><%= userInfo.name %></h4>
              <h5 class="card-title"><%= userInfo.post %></h5>
              <p class="card-text"><%= userInfo.tagline%></p>
              <p class="card-text">Semester: <%= userInfo.semester%></p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="container">
      <div class="row justify-content-center">
        <div class="col-3">
          <div class="card border-0 shadow-md bg-warning text-center">
            <div class="card-body">
              <h5>Votes</h5>
              <h1><%=voteCount%></h1>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- edit details form -->
    <div class="modal" tabindex="-1" id="edit-modal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-body">
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>

            <form action="/candidate/profile/update" method="post">
              <div class="mb-2">
                <label for="name">Name</label>
                <input
                  type="text"
                  placeholder="enter name"
                  name="name"
                  id="name"
                  value="<%=userInfo.name%>"
                  class="form-control"
                />
              </div>
              <div class="mb-2">
                <label for="slogan">Slogan</label>
                <input
                  type="text"
                  placeholder="enter slogan"
                  name="slogan"
                  id="slogan"
                  value="<%=userInfo.tagline%>"
                  class="form-control"
                />
              </div>
              <div class="mb-2">
                <label for="name">Semester</label>
                <input
                  type="text"
                  placeholder="enter semester"
                  name="semester"
                  id="semester"
                  value="<%=userInfo.semester%>"
                  class="form-control"
                />
              </div>
              <input type="hidden" name="id" value="<%= userInfo.id%>" />
              <input
                type="submit"
                value="submit"
                class="btn btn-success btn-sm"
              />
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- upload photo -->
    <div class="modal" tabindex="-1" id="upload-modal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-body">
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>

            <form
              action="/upload-avatar"
              method="post"
              enctype="multipart/form-data"
            >
              <div class="mb-2">
                <label for="avatar">Avatar</label>
                <input
                  type="file"
                  name="avatar"
                  id="avatar"
                  class="form-control"
                />
              </div>
              <input type="hidden" name="id" value="<%= userInfo.id%>" />
              <input
                type="submit"
                value="submit"
                class="btn btn-success btn-sm"
              />
            </form>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
